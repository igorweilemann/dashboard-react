{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/weilemann/code/react/dashboard-react/app/seed/route.ts"],"sourcesContent":["import bcrypt from 'bcrypt';\nimport { db } from '@vercel/postgres';\nimport { invoices, customers, revenue, users } from '../lib/placeholder-data';\n\n// const client = await db.connect();\n\n// async function seedUsers() {\n//   await client.sql`CREATE EXTENSION IF NOT EXISTS \"uuid-ossp\"`;\n//   await client.sql`\n//     CREATE TABLE IF NOT EXISTS users (\n//       id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n//       name VARCHAR(255) NOT NULL,\n//       email TEXT NOT NULL UNIQUE,\n//       password TEXT NOT NULL\n//     );\n//   `;\n\n//   const insertedUsers = await Promise.all(\n//     users.map(async (user) => {\n//       const hashedPassword = await bcrypt.hash(user.password, 10);\n//       return client.sql`\n//         INSERT INTO users (id, name, email, password)\n//         VALUES (${user.id}, ${user.name}, ${user.email}, ${hashedPassword})\n//         ON CONFLICT (id) DO NOTHING;\n//       `;\n//     }),\n//   );\n\n//   return insertedUsers;\n// }\n\n// async function seedInvoices() {\n//   await client.sql`CREATE EXTENSION IF NOT EXISTS \"uuid-ossp\"`;\n\n//   await client.sql`\n//     CREATE TABLE IF NOT EXISTS invoices (\n//       id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n//       customer_id UUID NOT NULL,\n//       amount INT NOT NULL,\n//       status VARCHAR(255) NOT NULL,\n//       date DATE NOT NULL\n//     );\n//   `;\n\n//   const insertedInvoices = await Promise.all(\n//     invoices.map(\n//       (invoice) => client.sql`\n//         INSERT INTO invoices (customer_id, amount, status, date)\n//         VALUES (${invoice.customer_id}, ${invoice.amount}, ${invoice.status}, ${invoice.date})\n//         ON CONFLICT (id) DO NOTHING;\n//       `,\n//     ),\n//   );\n\n//   return insertedInvoices;\n// }\n\n// async function seedCustomers() {\n//   await client.sql`CREATE EXTENSION IF NOT EXISTS \"uuid-ossp\"`;\n\n//   await client.sql`\n//     CREATE TABLE IF NOT EXISTS customers (\n//       id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n//       name VARCHAR(255) NOT NULL,\n//       email VARCHAR(255) NOT NULL,\n//       image_url VARCHAR(255) NOT NULL\n//     );\n//   `;\n\n//   const insertedCustomers = await Promise.all(\n//     customers.map(\n//       (customer) => client.sql`\n//         INSERT INTO customers (id, name, email, image_url)\n//         VALUES (${customer.id}, ${customer.name}, ${customer.email}, ${customer.image_url})\n//         ON CONFLICT (id) DO NOTHING;\n//       `,\n//     ),\n//   );\n\n//   return insertedCustomers;\n// }\n\n// async function seedRevenue() {\n//   await client.sql`\n//     CREATE TABLE IF NOT EXISTS revenue (\n//       month VARCHAR(4) NOT NULL UNIQUE,\n//       revenue INT NOT NULL\n//     );\n//   `;\n\n//   const insertedRevenue = await Promise.all(\n//     revenue.map(\n//       (rev) => client.sql`\n//         INSERT INTO revenue (month, revenue)\n//         VALUES (${rev.month}, ${rev.revenue})\n//         ON CONFLICT (month) DO NOTHING;\n//       `,\n//     ),\n//   );\n\n//   return insertedRevenue;\n// }\n\n// export async function GET() {\n//   try {\n//     await client.sql`BEGIN`;\n//     await seedUsers();\n//     await seedCustomers();\n//     await seedInvoices();\n//     await seedRevenue();\n//     await client.sql`COMMIT`;\n\n//     return Response.json({ message: 'Database seeded successfully' });\n//   } catch (error) {\n//     await client.sql`ROLLBACK`;\n//     return Response.json({ error }, { status: 500 });\n//   }\n// }\nconst client = await db.connect();\n\nasync function cleanUpDatabase() {\n  try {\n    await client.sql`BEGIN`;\n\n    // Remove duplicate users, keeping the earliest ID\n    await client.sql`\n      DELETE FROM users\n      WHERE id NOT IN (\n          SELECT MIN(id) FROM users GROUP BY email\n      );\n    `;\n\n    // Remove duplicate customers, keeping the earliest ID\n    await client.sql`\n      DELETE FROM customers\n      WHERE id NOT IN (\n          SELECT MIN(id) FROM customers GROUP BY email\n      );\n    `;\n\n    // Remove duplicate invoices, keeping the earliest ID for each customer\n    await client.sql`\n      DELETE FROM invoices\n      WHERE id NOT IN (\n          SELECT MIN(id) FROM invoices GROUP BY customer_id, amount, status, date\n      );\n    `;\n\n    // Remove duplicate revenue entries, keeping the earliest entry for each month\n    await client.sql`\n      DELETE FROM revenue\n      WHERE ctid NOT IN (\n          SELECT MIN(ctid) FROM revenue GROUP BY month\n      );\n    `;\n\n    await client.sql`COMMIT`;\n    console.log('Database cleanup successful.');\n    return { message: 'Database cleanup successful' };\n  } catch (error) {\n    await client.sql`ROLLBACK`;\n    console.error('Database cleanup failed:', error);\n    return { error: 'Database cleanup failed' };\n  }\n}\n\n// Run the cleanup function when this file is executed\ncleanUpDatabase().then((result) => console.log(result));"],"names":[],"mappings":";AACA;AAAA;;AAGA,qCAAqC;AAErC,+BAA+B;AAC/B,kEAAkE;AAClE,sBAAsB;AACtB,yCAAyC;AACzC,wDAAwD;AACxD,oCAAoC;AACpC,oCAAoC;AACpC,+BAA+B;AAC/B,SAAS;AACT,OAAO;AAEP,6CAA6C;AAC7C,kCAAkC;AAClC,qEAAqE;AACrE,2BAA2B;AAC3B,wDAAwD;AACxD,8EAA8E;AAC9E,uCAAuC;AACvC,WAAW;AACX,UAAU;AACV,OAAO;AAEP,0BAA0B;AAC1B,IAAI;AAEJ,kCAAkC;AAClC,kEAAkE;AAElE,sBAAsB;AACtB,4CAA4C;AAC5C,wDAAwD;AACxD,mCAAmC;AACnC,6BAA6B;AAC7B,sCAAsC;AACtC,2BAA2B;AAC3B,SAAS;AACT,OAAO;AAEP,gDAAgD;AAChD,oBAAoB;AACpB,iCAAiC;AACjC,mEAAmE;AACnE,iGAAiG;AACjG,uCAAuC;AACvC,WAAW;AACX,SAAS;AACT,OAAO;AAEP,6BAA6B;AAC7B,IAAI;AAEJ,mCAAmC;AACnC,kEAAkE;AAElE,sBAAsB;AACtB,6CAA6C;AAC7C,wDAAwD;AACxD,oCAAoC;AACpC,qCAAqC;AACrC,wCAAwC;AACxC,SAAS;AACT,OAAO;AAEP,iDAAiD;AACjD,qBAAqB;AACrB,kCAAkC;AAClC,6DAA6D;AAC7D,8FAA8F;AAC9F,uCAAuC;AACvC,WAAW;AACX,SAAS;AACT,OAAO;AAEP,8BAA8B;AAC9B,IAAI;AAEJ,iCAAiC;AACjC,sBAAsB;AACtB,2CAA2C;AAC3C,0CAA0C;AAC1C,6BAA6B;AAC7B,SAAS;AACT,OAAO;AAEP,+CAA+C;AAC/C,mBAAmB;AACnB,6BAA6B;AAC7B,+CAA+C;AAC/C,gDAAgD;AAChD,0CAA0C;AAC1C,WAAW;AACX,SAAS;AACT,OAAO;AAEP,4BAA4B;AAC5B,IAAI;AAEJ,gCAAgC;AAChC,UAAU;AACV,+BAA+B;AAC/B,yBAAyB;AACzB,6BAA6B;AAC7B,4BAA4B;AAC5B,2BAA2B;AAC3B,gCAAgC;AAEhC,yEAAyE;AACzE,sBAAsB;AACtB,kCAAkC;AAClC,wDAAwD;AACxD,MAAM;AACN,IAAI;AACJ,MAAM,SAAS,MAAM,yRAAA,CAAA,KAAE,CAAC,OAAO;AAE/B,eAAe;IACb,IAAI;QACF,MAAM,OAAO,GAAG,CAAC,KAAK,CAAC;QAEvB,kDAAkD;QAClD,MAAM,OAAO,GAAG,CAAC;;;;;IAKjB,CAAC;QAED,sDAAsD;QACtD,MAAM,OAAO,GAAG,CAAC;;;;;IAKjB,CAAC;QAED,uEAAuE;QACvE,MAAM,OAAO,GAAG,CAAC;;;;;IAKjB,CAAC;QAED,8EAA8E;QAC9E,MAAM,OAAO,GAAG,CAAC;;;;;IAKjB,CAAC;QAED,MAAM,OAAO,GAAG,CAAC,MAAM,CAAC;QACxB,QAAQ,GAAG,CAAC;QACZ,OAAO;YAAE,SAAS;QAA8B;IAClD,EAAE,OAAO,OAAO;QACd,MAAM,OAAO,GAAG,CAAC,QAAQ,CAAC;QAC1B,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;YAAE,OAAO;QAA0B;IAC5C;AACF;AAEA,sDAAsD;AACtD,kBAAkB,IAAI,CAAC,CAAC,SAAW,QAAQ,GAAG,CAAC"}},
    {"offset": {"line": 300, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}